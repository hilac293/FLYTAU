{% extends "base.html" %}

{% block title %}תוצאות חיפוש טיסות{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='flights_reasults.css') }}">
{% endblock %}

{% block content %}

<body class="search-results">

{% if flights %}
    <h1>תחזיקו חזק... אנחנו ממריאים!</h1>
    <p>מצאנו {{ flights|length }} טיסות שזמינות ל-{{ passengers }} נוסעים</p>

    <table>
        <thead>
            <tr>
                <th>מספר טיסה</th>
                <th>מקור</th>
                <th>יעד</th>
                <th>המראה</th>
                <th>נחיתה</th>
                <th>מחיר רגיל</th>
                <th>מחיר עסקים</th>
                <th>פעולה</th>
            </tr>
        </thead>
        <tbody>
            {% for flight in flights %}
            <tr>
                <td>{{ flight.flight_id }}</td>
                <td>{{ flight.origin }}</td>
                <td>{{ flight.destination }}</td>
                <td>{{ flight.departure_datetime.strftime('%Y-%m-%d %H:%M') }}</td>
                <td>{{ flight.arrival_datetime.strftime('%Y-%m-%d %H:%M') }}</td>
                <td>{{ flight.regular_price }}₪</td>
                <td>
                    {% if flight.business_price is none %}
                        -
                    {% else %}
                        {{ flight.business_price }}₪
                    {% endif %}
                </td>

                <td>
                    <form action="{{ url_for('book_flight') }}" method="POST">
                        <input type="hidden" name="flight_id" value="{{ flight.flight_id }}">
                        <input type="hidden" name="passengers" value="{{ passengers }}">
                        <input type="hidden" name="origin" value="{{ flight.origin }}">
                        <input type="hidden" name="destination" value="{{ flight.destination }}">
                        <input type="hidden" name="departure_datetime" value="{{ flight.departure_datetime }}">
                        <input type="hidden" name="arrival_datetime" value="{{ flight.arrival_datetime }}">
                        <input type="hidden" name="regular_price" value="{{ flight.regular_price }}">
                        <input type="hidden" name="business_price"
                               value="{% if flight.business_price is none %}{% else %}{{ flight.business_price }}{% endif %}">

                        <button type="submit" class="btn">בחר טיסה</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
<div class="no-flights-container">
    <img src="{{ url_for('static', filename='imgs/flights_not_found.png') }}"
         alt="No flights found"
         class="no-flights-image">

    <h2 class="no-flights-title">לא נמצאו טיסות</h2>
    <p class="no-flights-text">
        לצערנו לא מצאנו טיסות שתואמות לחיפוש שלך.<br>
        נסו לשנות תאריכים, יעד או מספר נוסעים.
    </p>
</div>
{% endif %}

<a href="{{ url_for('homepage') }}" class="btn home-btn">חזרה לדף הבית</a>


</body>

{% endblock %}
